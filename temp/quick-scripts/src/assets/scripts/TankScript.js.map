{"version":3,"sources":["assets\\scripts\\TankScript.js"],"names":["TankType","require","tankType","cc","Class","Component","properties","Normal","type","speed","bullet","Prefab","fireTime","blood","team","blast","shootAudio","url","AudioClip","spriteFrames","SpriteFrame","die","stop","onLoad","_cityCtrl","find","getComponent","bulletNode","start","stopMove","offset","v2","Player","self","callback","callFunc","angles","index","parseInt","Math","random","tankMoveStart","startFire","bulletPool","seq","sequence","delayTime","node","runAction","repeatForever","angle","floor","cos","PI","sin","ceil","tankMoveStop","tankStop","director","getActionManager","pauseAllRunningActions","update","dt","boundingBox","getBoundingBox","rect","xMin","x","yMin","y","size","width","height","collisionTest","collisionTank","stopFire","i","gameData","tankList","length","tank","intersects","get","instantiate","pos","position","add","bulletMove","parent","camp","bulletList","push","boom","anim","Animation","play","tankBoom","turnGreen","opacity"],"mappings":"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","sourceRoot":"/","sourcesContent":["\r\nvar TankType = require(\"TankData\").tankType;\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n\r\n        //坦克类型\r\n        tankType: {\r\n            default: TankType.Normal,\r\n            type: TankType\r\n        }, \r\n        //速度\r\n        speed: 20,\r\n        //子弹\r\n        bullet: cc.Prefab,\r\n        //发射子弹间隔时间\r\n        fireTime: 0.5,\r\n        //血量\r\n        blood: 1,\r\n        //所属组织\r\n        team: 0,\r\n        //爆炸动画\r\n        blast: cc.Prefab,\r\n        //射击音效\r\n        shootAudio: {\r\n            default: null,\r\n            url: cc.AudioClip,\r\n        },\r\n        //坦克皮肤\r\n        spriteFrames: {\r\n            default: [],\r\n            type: cc.SpriteFrame,\r\n        },\r\n\r\n        die: false,\r\n        stop: false,\r\n\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        //获取组件\r\n        this._cityCtrl = cc.find(\"/CityScript\").getComponent(\"CityScript\");\r\n        this.bulletNode = cc.find(\"/Canvas/Map/layer_0\");\r\n        //this.bulletNode = cc.find(\"/Canvas/map1/layer0\");\r\n    },\r\n\r\n    start: function() {\r\n        //初始是停止状态的\r\n        this.stopMove = true;\r\n        this.stop = false;\r\n        //偏移量\r\n        this.offset = cc.v2();\r\n\r\n        if(this.tankType != TankType.Player){\r\n            var self = this;\r\n            //添加AI\r\n            var callback = cc.callFunc(function(){\r\n                var angles = [0, 90, 180, 270];\r\n                var index = parseInt(Math.random()*4, 10);\r\n                self.tankMoveStart(angles[index]);\r\n\r\n                self.startFire(self._cityCtrl.bulletPool);\r\n\r\n            }, this);\r\n\r\n            var seq = cc.sequence(cc.delayTime(0.3), callback, cc.delayTime(1));\r\n            this.node.runAction(cc.repeatForever(seq));\r\n        }\r\n\r\n    },\r\n\r\n    //添加坦克移动动作\r\n    tankMoveStart: function (angle) {\r\n\r\n        this.node.angle = angle - 90;\r\n\r\n        if(angle==0 || angle==180 || angle==90){\r\n            this.offset = cc.v2(Math.floor(Math.cos(Math.PI/180*angle)), \r\n                           Math.floor(Math.sin(Math.PI/180*angle)));\r\n        }else if(angle==270){\r\n\r\n            this.offset = cc.v2(Math.ceil(Math.cos(Math.PI/180*angle)),\r\n                                Math.floor(Math.sin(Math.PI/180*angle)));\r\n        }else {\r\n            this.offset = cc.v2(Math.cos(Math.PI/180*angle),\r\n                                Math.sin(Math.PI/180*angle));\r\n        }\r\n\r\n        this.stopMove = false;\r\n    },\r\n\r\n    //移除坦克移动动作\r\n    tankMoveStop: function () {\r\n        this.stopMove = true;\r\n    },\r\n\r\n    tankStop: function (){\r\n        this.stop = true;\r\n        cc.director.getActionManager().pauseAllRunningActions();\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n\r\n        if(this.stop){\r\n            return;\r\n        }\r\n\r\n        if(!this.stopMove){\r\n            var boundingBox = this.node.getBoundingBox();\r\n            var rect = cc.rect(boundingBox.xMin + this.offset.x*this.speed*dt*1.5,\r\n                               boundingBox.yMin + this.offset.y*this.speed*dt*1.7, \r\n\t\t                       boundingBox.size.width, \r\n                               boundingBox.size.height);\r\n            if(this._cityCtrl.collisionTest(rect) //检测与地图的碰撞\r\n                || this.collisionTank(rect)\r\n                ){\r\n                this.tankMoveStop();\r\n            }else {\r\n                this.node.x += this.offset.x*this.speed*dt;\r\n                this.node.y += this.offset.y*this.speed*dt;\r\n            }\r\n        }\r\n        if(this.stopFire){\r\n            this.fireTime -= dt;\r\n            if(this.fireTime<=0){\r\n                this.stopFire = false;\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    //判断是否与其他坦克碰撞\r\n    collisionTank: function(rect) {\r\n        for(var i=0; i<cc.gameData.tankList.length; i++){\r\n            var tank = cc.gameData.tankList[i]\r\n            if(this.node === tank){\r\n                continue;\r\n            }\r\n            var boundingBox = tank.getBoundingBox();\r\n            // if(cc.rectIntersectsRect(rect, boundingBox)){\r\n            if(rect.intersects(boundingBox)){  \r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    },\r\n\r\n    //开火\r\n    startFire: function (bulletPool){\r\n        if(this.stopFire){\r\n            return false;\r\n        }\r\n        this.stopFire = true;\r\n        this.fireTime = 0.5;\r\n\r\n        var bullet = null;\r\n        if(bulletPool.size()>0){\r\n            bullet = bulletPool.get(bulletPool);\r\n        }else {\r\n            bullet = cc.instantiate(this.bullet);\r\n        }\r\n        //设置子弹位置,角度\r\n        bullet.angle = this.node.angle;\r\n        var pos = this.node.position;\r\n\r\n        var angle = this.node.angle - 90;\r\n        var offset = cc.v2(0, 0);\r\n        if(angle==0 || angle==180 || angle==90){\r\n            offset = cc.v2(Math.floor(Math.cos(Math.PI/180*angle)), \r\n                                Math.floor(Math.sin(Math.PI/180*angle)));\r\n        }else if(angle==270){\r\n            offset = cc.v2(Math.ceil(Math.cos(Math.PI/180*angle)),\r\n                                Math.floor(Math.sin(Math.PI/180*angle)));\r\n        }else {\r\n            offset = cc.v2(Math.cos(Math.PI/180*angle),\r\n                                Math.sin(Math.PI/180*angle));\r\n        }\r\n\r\n        if(angle == -90){\r\n            //cc.log(\"上\");\r\n            bullet.position = pos.add(cc.v2(10*offset.x, 10*offset.y + 15));\r\n        }else if(angle == 0){\r\n            //cc.log(\"左\");\r\n            bullet.position = pos.add(cc.v2(10*offset.x - 15, 10*offset.y));\r\n        }else if(angle == -180){\r\n            //cc.log(\"右\");\r\n            bullet.position = pos.add(cc.v2(10*offset.x + 15, 10*offset.y));\r\n        }else if(angle == 90){\r\n            //cc.log(\"下\");\r\n            bullet.position = pos.add(cc.v2(10*offset.x, 10*offset.y - 15));\r\n        }\r\n\r\n        // bullet.position = cc.pAdd(pos,cc.v2(10*offset.x, 10*offset.y));\r\n\r\n        bullet.getComponent(\"BulletScript\").bulletMove();\r\n        bullet.parent = this.bulletNode;\r\n        //子弹标记\r\n        bullet.camp = this.team;\r\n        \r\n\r\n        //加到列表\r\n        cc.gameData.bulletList.push(bullet);\r\n\r\n        return true;\r\n    },\r\n\r\n    //爆炸\r\n    boom: function(){\r\n        var blast = cc.instantiate(this.blast);\r\n        blast.parent = this.node.parent;\r\n        blast.position = this.node.position;\r\n        var anim = blast.getComponent(cc.Animation);\r\n        anim.play();\r\n        this._cityCtrl.tankBoom(this.node);\r\n    },\r\n\r\n    turnGreen: function(index){\r\n        //this.node.getComponent(cc.Sprite).spriteFrame = this.spriteFrames[index];\r\n        if(index == 0){\r\n            this.node.opacity = 55\r\n        }else{\r\n            this.node.opacity = 255\r\n        }\r\n    },\r\n\r\n});\r\n"]}